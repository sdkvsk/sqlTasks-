Лабораторна 4

-- 1. Вивести статистику: загальна кількість всіх книг, їх вартість, їх середню вартість, мінімальну і максимальну ціну
SELECT COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books;

-- 2. Вивести загальну кількість всіх книг без урахування книг з непроставленою ціною
SELECT COUNT(*) AS 'Загальна кількість' FROM Books WHERE ціна IS NOT NULL;

-- 3. Вивести статистику (див. 1) для книг новинка / не новинка
SELECT новинка, COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books GROUP BY новинка;

-- 4. Вивести статистику (див. 1) для книг за кожним роком видання
SELECT YEAR(Дата) AS 'Рік', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books GROUP BY YEAR(Дата);

-- 5. Змінити п.4, виключивши з статистики книги з ціною від 10 до 20
SELECT YEAR(Дата) AS 'Рік', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books WHERE ціна NOT BETWEEN 10 AND 20 GROUP BY YEAR(Дата);

-- 6. Змінити п.4. Відсортувати статистику по спадаючій кількості.
SELECT YEAR(Дата) AS 'Рік', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books GROUP BY YEAR(Дата) ORDER BY COUNT(*) DESC;

-- 7. Вивести загальну кількість кодів книг і кодів книг що не повторюються
SELECT COUNT(код) AS 'Загальна кількість кодів', COUNT(DISTINCT код) AS 'Кількість унікальних кодів' FROM Books;

-- 8. Вивести статистику: загальна кількість і вартість книг по першій букві її назви
SELECT LEFT(назва, 1) AS 'Перша буква', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість' FROM Books GROUP BY LEFT(назва, 1);

-- 9. Змінити п. 8, виключивши з статистики назви що починаються з англ. букви або з цифри.
SELECT LEFT(назва, 1) AS 'Перша буква', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість' FROM Books WHERE LEFT(назва, 1) NOT REGEXP '^[A-Za-z0-9]' GROUP BY LEFT(назва, 1);

-- 10. Змінити п. 9 так щоб до складу статистики потрапили дані з роками більшими за 2000.
SELECT LEFT(назва, 1) AS 'Перша буква', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість' FROM Books WHERE LEFT(назва, 1) NOT REGEXP '^[A-Za-z0-9]' AND YEAR(Дата) > 2000 GROUP BY LEFT(назва, 1);

-- 11. Змінити п. 10. Відсортувати статистику по спадаючій перших букв назви.
SELECT LEFT(назва, 1) AS 'Перша буква', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість' FROM Books WHERE LEFT(назва, 1) NOT REGEXP '^[A-Za-z0-9]' AND YEAR(Дата) > 2000 GROUP BY LEFT(назва, 1) ORDER BY LEFT(назва, 1) DESC;

-- 12. Вивести статистику (див. 1) по кожному місяцю кожного року.
SELECT YEAR(Дата) AS 'Рік', MONTH(Дата) AS 'Місяць', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books GROUP BY YEAR(Дата), MONTH(Дата);

-- 13. Змінити п. 12 так щоб до складу статистики не увійшли дані з незаповненими датами.
SELECT YEAR(Дата) AS 'Рік', MONTH(Дата) AS 'Місяць', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books WHERE Дата IS NOT NULL GROUP BY YEAR(Дата), MONTH(Дата);

-- 14. Змінити п. 12. Фільтр по спадаючій року і зростанню місяця.
SELECT YEAR(Дата) AS 'Рік', MONTH(Дата) AS 'Місяць', COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books GROUP BY YEAR(Дата), MONTH(Дата

-- 15. Вивести статистику для книг новинка / не новинка: загальна ціна, загальна ціна в грн. / Євро / руб. Колонкам запиту дати назви за змістом.
SELECT новинка, SUM(ціна) AS 'Загальна ціна', SUM(ціна * 27.5) AS 'Загальна ціна в грн.', SUM(ціна * 0.85) AS 'Загальна ціна в євро', SUM(ціна * 75) AS 'Загальна ціна в руб.' FROM Books GROUP BY новинка;

-- 16. Змінити п. 15 так щоб виводилася округлена до цілого числа (дол. / Грн. / Євро / руб.) Ціна.
SELECT новинка, ROUND(SUM(ціна)) AS 'Загальна ціна', ROUND(SUM(ціна * 27.5)) AS 'Загальна ціна в грн.', ROUND(SUM(ціна * 0.85)) AS 'Загальна ціна в євро', ROUND(SUM(ціна * 75)) AS 'Загальна ціна в руб.' FROM Books GROUP BY новинка;

-- 17. Вивести статистику (див. 1) по видавництвах.
SELECT видавництво, COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books GROUP BY видавництво;

-- 18. Вивести статистику (див. 1) за темами і видавництвами. Фільтр по видавництвам.
-- Це залежить від того, які видавництва ви хочете включити в фільтр. Ось приклад, якщо ви хочете включити видавництво 'Видавнича група BHV':
SELECT тема, видавництво, COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books WHERE видавництво = 'Видавнича група BHV' GROUP BY тема, видавництво;

-- 19. Вивести статистику (див. 1) за категоріями, темами і видавництвами. Фільтр по видавництвам, темах, категоріям.
-- Це залежить від того, які видавництва, теми та категорії ви хочете включити в фільтр. Ось приклад, якщо ви хочете включити видавництво 'Видавнича група BHV', тему 'Використання ПК в цілому' та категорію 'Підручники':
SELECT категорія, тема, видавництво, COUNT(*) AS 'Загальна кількість', SUM(ціна) AS 'Загальна вартість', AVG(ціна) AS 'Середня вартість', MIN(ціна) AS 'Мінімальна ціна', MAX(ціна) AS 'Максимальна ціна' FROM Books WHERE видавництво = 'Видавнича група BHV' AND тема = 'Використання ПК в цілому' AND категорія = 'Підручники' GROUP BY категорія, тема, видавництво;

-- 20. Вивести список видавництв, у яких округлена до цілого ціна однієї сторінки більше 10 копійок.
SELECT видавництво FROM Books WHERE ROUND(ціна / сторінки * 100) > 10 GROUP BY видавництво;

